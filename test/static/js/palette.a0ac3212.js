(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["palette"],{"25f0":function(t,e,n){"use strict";var i=n("6eeb"),a=n("825a"),s=n("d039"),r=n("ad6d"),o="toString",c=RegExp.prototype,l=c[o],h=s((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),u=l.name!=o;(h||u)&&i(RegExp.prototype,o,(function(){var t=a(this),e=String(t.source),n=t.flags,i=String(void 0===n&&t instanceof RegExp&&!("flags"in c)?r.call(t):n);return"/"+e+"/"+i}),{unsafe:!0})},"3ca3":function(t,e,n){"use strict";var i=n("6547").charAt,a=n("69f3"),s=n("7dd0"),r="String Iterator",o=a.set,c=a.getterFor(r);s(String,"String",(function(t){o(this,{type:r,string:String(t),index:0})}),(function(){var t,e=c(this),n=e.string,a=e.index;return a>=n.length?{value:void 0,done:!0}:(t=i(n,a),e.index+=t.length,{value:t,done:!1})}))},"4df4":function(t,e,n){"use strict";var i=n("0366"),a=n("7b0b"),s=n("9bdd"),r=n("e95a"),o=n("50c4"),c=n("8418"),l=n("35a1");t.exports=function(t){var e,n,h,u,d,p,f=a(t),v="function"==typeof this?this:Array,g=arguments.length,m=g>1?arguments[1]:void 0,y=void 0!==m,b=l(f),w=0;if(y&&(m=i(m,g>2?arguments[2]:void 0,2)),void 0==b||v==Array&&r(b))for(e=o(f.length),n=new v(e);e>w;w++)p=y?m(f[w],w):f[w],c(n,w,p);else for(u=b.call(f),d=u.next,n=new v;!(h=d.call(u)).done;w++)p=y?s(u,m,[h.value,w],!0):h.value,c(n,w,p);return n.length=w,n}},5507:function(t,e,n){"use strict";n("e924")},6547:function(t,e,n){var i=n("a691"),a=n("1d80"),s=function(t){return function(e,n){var s,r,o=String(a(e)),c=i(n),l=o.length;return c<0||c>=l?t?"":void 0:(s=o.charCodeAt(c),s<55296||s>56319||c+1===l||(r=o.charCodeAt(c+1))<56320||r>57343?t?o.charAt(c):s:t?o.slice(c,c+2):r-56320+(s-55296<<10)+65536)}};t.exports={codeAt:s(!1),charAt:s(!0)}},"65f0":function(t,e,n){var i=n("861d"),a=n("e8b5"),s=n("b622"),r=s("species");t.exports=function(t,e){var n;return a(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?i(n)&&(n=n[r],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},"74e85":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"remote1",attrs:{"element-loading-text":t.loadingText,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[t.isJoin?t._e():n("div",{staticClass:"shade"},[n("div",{staticClass:"input-container"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{type:"text",placeholder:"请输入你的昵称"},domProps:{value:t.account},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.join(e)},input:function(e){e.target.composing||(t.account=e.target.value)}}}),n("button",{on:{click:t.join}},[t._v("确定")])])]),n("div",{staticClass:"userList"},[n("h5",[t._v("在线用户："+t._s(t.userList.length))]),t._l(t.userList,(function(e){return n("p",{key:e.account},[t._v(" "+t._s(e.account)+" "),e.account===t.account||e.account===t.isCall?n("i",[t._v(" "+t._s(e.account===t.account?"me":"")+" "+t._s(e.account===t.isCall?"calling":"")+" ")]):t._e(),e.account!==t.account&&e.account!==t.isCall?n("span",{on:{click:function(n){return t.apply(e.account)}}},[t._v("呼叫 "+t._s(e.account))]):t._e()])}))],2),n("div",{staticClass:"video-container"},[n("div",[n("ul",t._l(t.handleList,(function(e){return n("li",{key:e.type},["color"===e.type?n("el-color-picker",{attrs:{"show-alpha":"",disabled:!t.isToPeer},on:{change:t.colorChange},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}}):t._e(),["color","lineWidth","polygon"].includes(e.type)?t._e():n("button",{class:{active:t.currHandle===e.type},attrs:{disabled:"cancel"===e.type?!t.isToPeer||t.allowCancel:"go"===e.type?!t.isToPeer||t.allowGo:!t.isToPeer},on:{click:function(n){return t.handleClick(e)}}},[t._v(t._s(e.name))]),"polygon"===e.type?n("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"}},[n("el-input-number",{attrs:{"controls-position":"right",min:3,max:10},on:{change:t.sidesChange},model:{value:t.sides,callback:function(e){t.sides=e},expression:"sides"}}),n("button",{class:{active:t.currHandle===e.type},attrs:{slot:"reference",disabled:!t.isToPeer},on:{click:function(n){return t.handleClick(e)}},slot:"reference"},[t._v(t._s(e.name))])],1):t._e(),"lineWidth"===e.type?n("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"}},[n("el-slider",{attrs:{max:20},on:{change:t.lineWidthChange},model:{value:t.lineWidth,callback:function(e){t.lineWidth=e},expression:"lineWidth"}}),n("button",{attrs:{slot:"reference",disabled:!t.isToPeer},slot:"reference"},[t._v(t._s(e.name)+" "),n("i",[t._v(t._s(t.lineWidth+"px"))])])],1):t._e()],1)})),0),n("div",[n("h5",[t._v("画板")]),n("canvas",{ref:"canvas",attrs:{width:"400",height:"300"}})])]),n("div",[n("h5",[t._v("聊天")]),n("div",{staticClass:"chat"},t._l(t.messageList,(function(e,i){return n("div",{key:i,staticClass:"message"},[n("p",[t._v(" "+t._s(e.account)+" - "+t._s(e.time)+" ")]),n("p",{staticClass:"mes"},[t._v(t._s(e.mes))])])})),0),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.sendText,expression:"sendText"}],domProps:{value:t.sendText},on:{input:function(e){e.target.composing||(t.sendText=e.target.value)}}}),t._v(" "),n("br"),n("button",{attrs:{disabled:!t.isToPeer},on:{click:function(e){return t.send(["text"])}}},[t._v("发送")])])])])},a=[];n("caad"),n("a15b9"),n("d81d"),n("fb6a"),n("d3b7"),n("25f0");function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function r(t){if(Array.isArray(t))return s(t)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("3ca3"),n("ddb0");function o(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}n("b0c0");function c(t,e){if(t){if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t){return r(t)||o(t)||c(t)||l()}function u(t){if(Array.isArray(t))return t}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t){return u(t)||o(t)||c(t)||d()}n("96cf");var f=n("c964"),v=n("ebd6"),g={name:"palette",data:function(){return{account:window.sessionStorage.account||"",isJoin:!1,userList:[],roomid:"palette",isCall:!1,loading:!1,loadingText:"呼叫中",isToPeer:!1,peer:null,offerOption:{offerToReceiveAudio:1,offerToReceiveVideo:1},handleList:[{name:"圆",type:"arc"},{name:"线条",type:"line"},{name:"矩形",type:"rect"},{name:"多边形",type:"polygon"},{name:"橡皮擦",type:"eraser"},{name:"撤回",type:"cancel"},{name:"前进",type:"go"},{name:"清屏",type:"clear"},{name:"线宽",type:"lineWidth"},{name:"颜色",type:"color"}],color:"rgba(19, 206, 102, 1)",currHandle:"line",lineWidth:5,palette:null,allowCancel:!0,allowGo:!0,sides:3,channel:null,messageList:[],sendText:""}},methods:{formatTime:function(t){var e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return[e,n,i].map(this.formatNumber).join(":")},formatNumber:function(t){return t=t.toString(),t[1]?t:"0"+t},send:function(t){if("text"===t[0]){var e={account:this.account,time:this.formatTime(new Date),mes:this.sendText,type:"text"};this.channel.send(JSON.stringify(e)),this.messageList.push(e),this.sendText=""}else console.log("send",t),this.channel.send(JSON.stringify(t))},initPalette:function(){this.palette=new v["a"](this.$refs["canvas"],{drawColor:this.color,drawType:this.currHandle,lineWidth:this.lineWidth,allowCallback:this.allowCallback,moveCallback:this.moveCallback})},moveCallback:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.send(e)},allowCallback:function(t,e){this.allowCancel=!t,this.allowGo=!e},sidesChange:function(){this.palette.changeWay({sides:this.sides})},colorChange:function(){this.palette.changeWay({color:this.color})},lineWidthChange:function(){this.palette.changeWay({lineWidth:this.lineWidth})},handleClick:function(t){if(["cancel","go","clear"].includes(t.type))return this.moveCallback(t.type),void this.palette[t.type]();this.palette.changeWay({type:t.type}),["color","lineWidth"].includes(t.type)||(this.currHandle=t.type)},join:function(){this.account&&(this.isJoin=!0,window.sessionStorage.account=this.account,socket.emit("join",{roomid:this.roomid,account:this.account}))},initSocket:function(){var t=this;socket.on("joined",(function(e){t.userList=e})),socket.on("reply",function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.loading=!1,e.t0=n.type,e.next="1"===e.t0?4:"2"===e.t0?11:"3"===e.t0?13:15;break;case 4:return t.isCall=n.self,e.next=7,t.createP2P(n);case 7:return e.next=9,t.createDataChannel();case 9:return t.createOffer(n),e.abrupt("break",15);case 11:return t.$message({message:"对方拒绝了你的请求！",type:"warning"}),e.abrupt("break",15);case 13:return t.$message({message:"对方正在通话中！",type:"warning"}),e.abrupt("break",15);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),socket.on("apply",(function(e){t.isCall?t.reply(e.self,"3"):t.$confirm(e.self+" 向你请求视频通话, 是否同意?","提示",{confirmButtonText:"同意",cancelButtonText:"拒绝",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.createP2P(e);case 2:return n.next=4,t.onDataChannel();case 4:t.isCall=e.self,t.reply(e.self,"1");case 6:case"end":return n.stop()}}),n)})))).catch((function(){t.reply(e.self,"2")}))})),socket.on("1v1answer",(function(e){t.onAnswer(e)})),socket.on("1v1ICE",(function(e){t.onIce(e)})),socket.on("1v1offer",(function(e){t.onOffer(e)})),socket.on("1v1hangup",(function(e){t.clearState(),t.$message({message:"对方已断开连接！",type:"warning"})}))},hangup:function(){socket.emit("1v1hangup",{account:this.isCall,self:this.account}),this.clearState()},clearState:function(){this.peer.close(),this.channel.close(),this.palette.destroy(),this.peer=null,this.palette=null,this.channel=null,this.isToPeer=!1,this.isCall=!1},apply:function(t){this.loading=!0,this.loadingText="呼叫中",socket.emit("apply",{account:t,self:this.account})},reply:function(t,e){socket.emit("reply",{account:t,self:this.account,type:e})},createP2P:function(t){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.loading=!0,e.loadingText="正在建立通话连接",n.next=4,e.initPeer(t);case 4:case"end":return n.stop()}}),n)})))()},createDataChannel:function(){try{this.channel=this.peer.createDataChannel("messagechannel"),this.handleChannel(this.channel)}catch(t){console.log("createDataChannel:",t)}},onDataChannel:function(){var t=this;this.peer.ondatachannel=function(e){t.channel=e.channel,t.handleChannel(t.channel)}},handleChannel:function(t){var e=this;t.binaryType="arraybuffer",t.onopen=function(t){console.log("channel onopen",t),e.isToPeer=!0,e.loading=!1,e.initPalette()},t.onclose=function(t){console.log("channel onclose",t)},t.onmessage=function(t){if(Array.isArray(JSON.parse(t.data))){var n,i=JSON.parse(t.data),a=p(i),s=a[0],r=a.slice(1);(n=e.palette)[s].apply(n,h(r))}else e.messageList.push(JSON.parse(t.data))}},initPeer:function(t){var e=this,n=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;this.peer=new n,this.peer.onicecandidate=function(n){n.candidate&&socket.emit("1v1ICE",{account:t.self,self:e.account,sdp:n.candidate})}},createOffer:function(t){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.peer.createOffer(e.offerOption);case 3:return i=n.sent,n.next=6,e.peer.setLocalDescription(i);case 6:socket.emit("1v1offer",{account:t.self,self:e.account,sdp:i}),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](0),console.log("createOffer: ",n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})))()},onOffer:function(t){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.peer.setRemoteDescription(t.sdp);case 3:return n.next=5,e.peer.createAnswer();case 5:return i=n.sent,n.next=8,e.peer.setLocalDescription(i);case 8:socket.emit("1v1answer",{account:t.self,self:e.account,sdp:i}),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](0),console.log("onOffer: ",n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))()},onAnswer:function(t){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.peer.setRemoteDescription(t.sdp);case 3:n.next=8;break;case 5:n.prev=5,n.t0=n["catch"](0),console.log("onAnswer: ",n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})))()},onIce:function(t){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.peer.addIceCandidate(t.sdp);case 3:n.next=8;break;case 5:n.prev=5,n.t0=n["catch"](0),console.log("onAnswer: ",n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})))()}},mounted:function(){this.account}},m=g,y=(n("5507"),n("2877")),b=Object(y["a"])(m,i,a,!1,null,"a74584c8",null);e["default"]=b.exports},8418:function(t,e,n){"use strict";var i=n("c04e"),a=n("9bf2"),s=n("5c6c");t.exports=function(t,e,n){var r=i(e);r in t?a.f(t,r,s(0,n)):t[r]=n}},"9bdd":function(t,e,n){var i=n("825a"),a=n("2a62");t.exports=function(t,e,n,s){try{return s?e(i(n)[0],n[1]):e(n)}catch(r){throw a(t),r}}},a15b9:function(t,e,n){"use strict";var i=n("23e7"),a=n("44ad"),s=n("fc6a"),r=n("a640"),o=[].join,c=a!=Object,l=r("join",",");i({target:"Array",proto:!0,forced:c||!l},{join:function(t){return o.call(s(this),void 0===t?",":t)}})},a630:function(t,e,n){var i=n("23e7"),a=n("4df4"),s=n("1c7e"),r=!s((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:r},{from:a})},a640:function(t,e,n){"use strict";var i=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){throw 1},1)}))}},ae40:function(t,e,n){var i=n("83ab"),a=n("d039"),s=n("5135"),r=Object.defineProperty,o={},c=function(t){throw t};t.exports=function(t,e){if(s(o,t))return o[t];e||(e={});var n=[][t],l=!!s(e,"ACCESSORS")&&e.ACCESSORS,h=s(e,0)?e[0]:c,u=s(e,1)?e[1]:void 0;return o[t]=!!n&&!a((function(){if(l&&!i)return!0;var t={length:-1};l?r(t,1,{enumerable:!0,get:c}):t[1]=1,n.call(t,h,u)}))}},b727:function(t,e,n){var i=n("0366"),a=n("44ad"),s=n("7b0b"),r=n("50c4"),o=n("65f0"),c=[].push,l=function(t){var e=1==t,n=2==t,l=3==t,h=4==t,u=6==t,d=7==t,p=5==t||u;return function(f,v,g,m){for(var y,b,w=s(f),k=a(w),C=i(v,g,3),x=r(k.length),S=0,T=m||o,A=e?T(f,x):n||d?T(f,0):void 0;x>S;S++)if((p||S in k)&&(y=k[S],b=C(y,S,w),t))if(e)A[S]=b;else if(b)switch(t){case 3:return!0;case 5:return y;case 6:return S;case 2:c.call(A,y)}else switch(t){case 4:return!1;case 7:c.call(A,y)}return u?-1:l||h?h:A}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterOut:l(7)}},caad:function(t,e,n){"use strict";var i=n("23e7"),a=n("4d64").includes,s=n("44d2"),r=n("ae40"),o=r("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:!o},{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),s("includes")},ddb0:function(t,e,n){var i=n("da84"),a=n("fdbc"),s=n("e260"),r=n("9112"),o=n("b622"),c=o("iterator"),l=o("toStringTag"),h=s.values;for(var u in a){var d=i[u],p=d&&d.prototype;if(p){if(p[c]!==h)try{r(p,c,h)}catch(v){p[c]=h}if(p[l]||r(p,l,u),a[u])for(var f in s)if(p[f]!==s[f])try{r(p,f,s[f])}catch(v){p[f]=s[f]}}}},e8b5:function(t,e,n){var i=n("c6b6");t.exports=Array.isArray||function(t){return"Array"==i(t)}},e924:function(t,e,n){},ebd6:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("99af"),n("fb6a");function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var r=function(){function t(e,n){var a=n.drawType,s=void 0===a?"line":a,r=n.drawColor,o=void 0===r?"rgba(19, 206, 102, 1)":r,c=n.lineWidth,l=void 0===c?5:c,h=n.sides,u=void 0===h?3:h,d=n.allowCallback,p=n.moveCallback;i(this,t),this.canvas=e,this.width=e.width,this.height=e.height,this.paint=e.getContext("2d"),this.isClickCanvas=!1,this.isMoveCanvas=!1,this.imgData=[],this.index=0,this.x=0,this.y=0,this.last=[this.x,this.y],this.drawType=s,this.drawColor=o,this.lineWidth=l,this.sides=u,this.allowCallback=d||function(){},this.moveCallback=p||function(){},this.bindMousemove=function(){},this.bindMousedown=function(){},this.bindMouseup=function(){},this.init()}return s(t,[{key:"init",value:function(){this.paint.fillStyle="#fff",this.paint.fillRect(0,0,this.width,this.height),this.gatherImage(),this.bindMousemove=this.onmousemove.bind(this),this.bindMousedown=this.onmousedown.bind(this),this.bindMouseup=this.onmouseup.bind(this),this.canvas.addEventListener("mousedown",this.bindMousedown),document.addEventListener("mouseup",this.bindMouseup)}},{key:"onmousedown",value:function(t){this.isClickCanvas=!0,this.x=t.offsetX,this.y=t.offsetY,this.last=[this.x,this.y],this.canvas.addEventListener("mousemove",this.bindMousemove)}},{key:"gatherImage",value:function(){this.imgData=this.imgData.slice(0,this.index+1);var t=this.paint.getImageData(0,0,this.width,this.height);this.imgData.push(t),this.index=this.imgData.length-1,this.allowCallback(this.index>0,this.index<this.imgData.length-1)}},{key:"reSetImage",value:function(){this.paint.clearRect(0,0,this.width,this.height),this.imgData.length>=1&&this.paint.putImageData(this.imgData[this.index],0,0)}},{key:"onmousemove",value:function(t){this.isMoveCanvas=!0;var e=t.offsetX,n=t.offsetY,i=e-this.x,a=n-this.y,s=[e,n];switch(this.drawType){case"line":var r=[this.last,s,this.lineWidth,this.drawColor];this.moveCallback.apply(this,["line"].concat(r)),this.line.apply(this,r);break;case"rect":var o=[this.x,this.y,i,a,this.lineWidth,this.drawColor];this.moveCallback.apply(this,["rect"].concat(o)),this.rect.apply(this,o);break;case"polygon":var c=[this.x,this.y,this.sides,i,a,this.lineWidth,this.drawColor];this.moveCallback.apply(this,["polygon"].concat(c)),this.polygon.apply(this,c);break;case"arc":var l=[this.x,this.y,i,a,this.lineWidth,this.drawColor];this.moveCallback.apply(this,["arc"].concat(l)),this.arc.apply(this,l);break;case"eraser":var h=[e,n,this.width,this.height,this.lineWidth];this.moveCallback.apply(this,["eraser"].concat(h)),this.eraser.apply(this,h);break}}},{key:"onmouseup",value:function(){this.isClickCanvas&&(this.isClickCanvas=!1,this.canvas.removeEventListener("mousemove",this.bindMousemove),this.isMoveCanvas&&(this.isMoveCanvas=!1,this.moveCallback("gatherImage"),this.gatherImage()))}},{key:"line",value:function(t,e,n,i){this.paint.beginPath(),this.paint.lineCap="round",this.paint.lineJoin="round",this.paint.lineWidth=n,this.paint.strokeStyle=i,this.paint.moveTo(t[0],t[1]),this.paint.lineTo(e[0],e[1]),this.paint.closePath(),this.paint.stroke(),this.last=e}},{key:"rect",value:function(t,e,n,i,a,s){this.reSetImage(),this.paint.lineWidth=a,this.paint.strokeStyle=s,this.paint.strokeRect(t,e,n,i)}},{key:"polygon",value:function(t,e,n,i,a,s,r){this.reSetImage();var o=n,c=360/o,l=Math.sqrt(Math.pow(i,2)+Math.pow(a,2));this.paint.beginPath(),this.paint.strokeStyle=r,this.paint.lineWidth=s;for(var h=0;h<o;h++)this.paint.lineTo(t+Math.sin((h*c+45)*Math.PI/180)*l,e+Math.cos((h*c+45)*Math.PI/180)*l);this.paint.closePath(),this.paint.stroke()}},{key:"arc",value:function(t,e,n,i,a,s){this.reSetImage(),this.paint.beginPath(),this.paint.lineWidth=a;var r=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.paint.arc(t,e,r,0,2*Math.PI,!1),this.paint.strokeStyle=s,this.paint.closePath(),this.paint.stroke()}},{key:"eraser",value:function(t,e,n,i,a){this.paint.save(),this.paint.beginPath(),this.paint.arc(t,e,a/2,0,2*Math.PI),this.paint.closePath(),this.paint.clip(),this.paint.clearRect(0,0,n,i),this.paint.fillStyle="#fff",this.paint.fillRect(0,0,n,i),this.paint.restore()}},{key:"cancel",value:function(){--this.index<0?this.index=0:(this.allowCallback(this.index>0,this.index<this.imgData.length-1),this.paint.putImageData(this.imgData[this.index],0,0))}},{key:"go",value:function(){++this.index>this.imgData.length-1?this.index=this.imgData.length-1:(this.allowCallback(this.index>0,this.index<this.imgData.length-1),this.paint.putImageData(this.imgData[this.index],0,0))}},{key:"clear",value:function(){this.imgData=[],this.paint.clearRect(0,0,this.width,this.height),this.paint.fillStyle="#fff",this.paint.fillRect(0,0,this.width,this.height),this.gatherImage()}},{key:"changeWay",value:function(t){var e=t.type,n=t.color,i=t.lineWidth,a=t.sides;this.drawType="color"!==e&&e||this.drawType,this.drawColor=n||this.drawColor,this.lineWidth=i||this.lineWidth,this.sides=a||this.sides}},{key:"destroy",value:function(){this.clear(),this.canvas.removeEventListener("mousedown",this.bindMousedown),document.removeEventListener("mouseup",this.bindMouseup),this.canvas=null,this.paint=null}}]),t}()},fb6a:function(t,e,n){"use strict";var i=n("23e7"),a=n("861d"),s=n("e8b5"),r=n("23cb"),o=n("50c4"),c=n("fc6a"),l=n("8418"),h=n("b622"),u=n("1dde"),d=n("ae40"),p=u("slice"),f=d("slice",{ACCESSORS:!0,0:0,1:2}),v=h("species"),g=[].slice,m=Math.max;i({target:"Array",proto:!0,forced:!p||!f},{slice:function(t,e){var n,i,h,u=c(this),d=o(u.length),p=r(t,d),f=r(void 0===e?d:e,d);if(s(u)&&(n=u.constructor,"function"!=typeof n||n!==Array&&!s(n.prototype)?a(n)&&(n=n[v],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return g.call(u,p,f);for(i=new(void 0===n?Array:n)(m(f-p,0)),h=0;p<f;p++,h++)p in u&&l(i,h,u[p]);return i.length=h,i}})},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);