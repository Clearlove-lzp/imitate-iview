(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["upload"],{1276:function(e,t,n){"use strict";var r=n("d784"),o=n("44e7"),a=n("825a"),i=n("1d80"),l=n("4840"),c=n("8aa5"),s=n("50c4"),u=n("14c3"),f=n("9263"),d=n("d039"),p=[].push,h=Math.min,v=4294967295,g=!d((function(){return!RegExp(v,"y")}));r("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(i(this)),a=void 0===n?v:n>>>0;if(0===a)return[];if(void 0===e)return[r];if(!o(e))return t.call(r,e,a);var l,c,s,u=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,g=new RegExp(e.source,d+"g");while(l=f.call(g,r)){if(c=g.lastIndex,c>h&&(u.push(r.slice(h,l.index)),l.length>1&&l.index<r.length&&p.apply(u,l.slice(1)),s=l[0].length,h=c,u.length>=a))break;g.lastIndex===l.index&&g.lastIndex++}return h===r.length?!s&&g.test("")||u.push(""):u.push(r.slice(h)),u.length>a?u.slice(0,a):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var o=i(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,o,n):r.call(String(o),t,n)},function(e,o){var i=n(r,e,this,o,r!==t);if(i.done)return i.value;var f=a(e),d=String(this),p=l(f,RegExp),b=f.unicode,x=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(g?"y":"g"),m=new p(g?f:"^(?:"+f.source+")",x),y=void 0===o?v:o>>>0;if(0===y)return[];if(0===d.length)return null===u(m,d)?[d]:[];var w=0,E=0,S=[];while(E<d.length){m.lastIndex=g?E:0;var k,_=u(m,g?d:d.slice(E));if(null===_||(k=h(s(m.lastIndex+(g?0:E)),d.length))===w)E=c(d,E,b);else{if(S.push(d.slice(w,E)),S.length===y)return S;for(var L=1;L<=_.length-1;L++)if(S.push(_[L]),S.length===y)return S;E=w=k}}return S.push(d.slice(w)),S}]}),!g)},"14c3":function(e,t,n){var r=n("c6b6"),o=n("9263");e.exports=function(e,t){var n=e.exec;if("function"===typeof n){var a=n.call(e,t);if("object"!==typeof a)throw TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},2679:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[e._v(" 参考： https://www.cnblogs.com/liuxianan/p/js-excel.html ")]),n("Divider",[e._v("测试一: 原生js + html + txt 上传")]),e._v(" 上传文件 ： "),n("input",{attrs:{type:"file",name:"file",id:"fileId"}}),n("Button",{on:{click:e.test1}},[e._v("提交")]),n("Divider",[e._v("测试二: iview + txt 上传（多个文件）")]),n("Upload",{attrs:{multiple:"",type:"drag",accept:".txt","default-file-list":e.defaultList,"before-upload":e.handleUpload,"on-remove":e.removeHandler,action:"/"}},[n("div",{staticStyle:{padding:"20px 0"}},[n("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),n("p",[e._v("点击或者拖拽上传")])],1)]),n("Button",{on:{click:e.test2}},[e._v("提交")]),n("Divider",[e._v("测试三: iview + excel (xlsx)上传（多个文件）")]),n("Upload",{attrs:{multiple:"",type:"drag",accept:".xlsx","default-file-list":e.defaultList3,"before-upload":e.handleUpload3,"on-remove":e.removeHandler3,action:"/"}},[n("div",{staticStyle:{padding:"20px 0"}},[n("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),n("p",[e._v("点击或者拖拽上传")])],1)]),n("Button",{on:{click:e.test3}},[e._v("提交")]),n("Button",{on:{click:e.download3}},[e._v("导出")]),n("div",{attrs:{id:"result"}}),n("Divider",[e._v("测试四: iview + excel (xlsx)上传（多个文件）+ 合并成一个excel")]),n("Upload",{attrs:{multiple:"",type:"drag",accept:".xlsx","default-file-list":e.defaultList4,"before-upload":e.handleUpload4,"on-remove":e.removeHandler4,action:"/"}},[n("div",{staticStyle:{padding:"20px 0"}},[n("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),n("p",[e._v("点击或者拖拽上传")])],1)]),n("Button",{on:{click:e.download4}},[e._v("导出一个excel")]),n("div",{attrs:{id:"result"}})],1)},o=[];n("99af"),n("4160"),n("d81d"),n("c19f"),n("b0c0"),n("d3b7"),n("ac1f"),n("3ca3"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("159b"),n("ddb0"),n("2b3d"),n("a4d3"),n("e01a"),n("d28b");function a(e){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}n("4de4"),n("e439"),n("dbb4"),n("b64b");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n("96cf");var s=n("c964"),u=n("1146"),f=n.n(u),d={props:{},data:function(){return{defaultList:[],defaultList3:[],defaultList4:[],sheetInfo:{SheetNames:[],Sheets:{}}}},components:{},computed:{},methods:{test1:function(){var e=document.getElementById("fileId");if(""==e.value)return alert("不能空");console.log(e.files);var t=e.files;if(0==t.length)alert("请选择文件");else{var n=new FileReader;n.readAsText(t[0],"utf-8"),n.onload=function(e){console.log(e.target.result)}}},handleUpload:function(e){if(/\.txt$/g.test(e.name))return this.defaultList.push(e),!1;alert("仅支持读取txt格式！")},removeHandler:function(e,t){this.defaultList=t},handleUpload3:function(e){if(/\.xlsx$/g.test(e.name))return this.defaultList3.push(e),!1;alert("仅支持读取xlsx格式！")},removeHandler3:function(e,t){this.defaultList3=t},handleUpload4:function(e){if(/\.xlsx$/g.test(e.name))return this.defaultList4.push(e),!1;alert("仅支持读取xlsx格式！")},removeHandler4:function(e,t){this.defaultList4=t},test2:function(){if(!this.defaultList.length)return alert("不能空");console.log(this.defaultList);var e=this.defaultList;0==e.length?alert("请选择文件"):e.map((function(e,t){var n=new FileReader;n.readAsText(e,"utf-8"),n.onload=function(e){console.log("第".concat(t+1,"个文件；   ").concat(e.target.result))}}))},test3:function(){var e=this;if(!this.defaultList3.length)return alert("不能空");console.log(this.defaultList3);var t=this.defaultList3;0==t.length?alert("请选择文件"):t.map((function(t,n){e.readWorkbookFromLocalFile(t,(function(t){e.readWorkbook(t)}))}))},download3:function(){var e=this;if(!this.defaultList3.length)return alert("不能空");console.log(this.defaultList3);var t=this.defaultList3;0==t.length?alert("请选择文件"):t.map((function(t,n){e.readWorkbookFromLocalFile(t,(function(t){var n=t.SheetNames,r=t.Sheets[n[0]],o=f.a.utils.sheet_to_csv(r),a=e.csv2sheet(o);a["!merges"]=r["!merges"],a["!margins"]=r["!margins"];var i=e.sheet2blob(a,n[0]);e.openDownloadDialog(i,"导出.xlsx")}))}))},download4:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.defaultList4.length){t.next=2;break}return t.abrupt("return",alert("不能空"));case 2:if(console.log(e.defaultList4),n=e.defaultList4,n.length){t.next=6;break}return t.abrupt("return",alert("请选择文件"));case 6:e.sheetInfo={SheetNames:[],Sheets:{}},r=0;case 8:if(!(r<n.length)){t.next=14;break}return t.next=11,e.readWorkbookFromLocalFile_test4(n[r]).then((function(t){for(var n=t.SheetNames,r=0;r<n.length;r++){e.sheetInfo.SheetNames.push(n[r]);var o=t.Sheets[n[r]],a=f.a.utils.sheet_to_csv(o),i=e.csv2sheet(a);o["!merges"]&&(i["!merges"]=o["!merges"]),o["!margins"]&&(i["!margins"]=o["!margins"]),e.sheetInfo.Sheets[n[r]]=i}}));case 11:r++,t.next=8;break;case 14:o=e.sheet2blob_more(e.sheetInfo),e.openDownloadDialog(o,"导出.xlsx");case 16:case"end":return t.stop()}}),t)})))()},readWorkbookFromLocalFile:function(e,t){var n=new FileReader;n.onload=function(e){var n=e.target.result,r=f.a.read(n,{type:"binary"});t&&t(r)},n.readAsBinaryString(e)},readWorkbookFromLocalFile_test4:function(e,t){return new Promise((function(t,n){console.log(222);var r=new FileReader;r.onload=function(e){var n=e.target.result,r=f.a.read(n,{type:"binary"});t(r)},r.readAsBinaryString(e)}))},readWorkbook:function(e){console.log(e);var t=e.SheetNames,n=e.Sheets[t[0]],r=f.a.utils.sheet_to_csv(n);document.getElementById("result").innerHTML=this.csv2table(r)},csv2table:function(e){var t="<table>",n=e.split("\n");return n.pop(),n.forEach((function(e,n){var r=e.split(",");if(r.unshift(n+1),0==n){t+="<tr>";for(var o=0;o<r.length;o++)t+="<th>"+(0==o?"":String.fromCharCode(65+o-1))+"</th>";t+="</tr>"}t+="<tr>",r.forEach((function(e){t+="<td>"+e+"</td>"})),t+="</tr>"})),t+="</table>",t},csv2sheet:function(e){var t={};return e=e.split("\n"),e.forEach((function(n,r){n=n.split(","),0==r&&(t["!ref"]="A1:"+String.fromCharCode(65+n.length-1)+(e.length-1)),n.forEach((function(e,n){t[String.fromCharCode(65+n)+(r+1)]={v:e}}))})),t},sheet2blob:function(e,t){t=t||"sheet1";var n={SheetNames:[t],Sheets:{}};n.Sheets[t]=e;var r={bookType:"xlsx",bookSST:!1,type:"binary"},o=f.a.write(n,r),a=new Blob([i(o)],{type:"application/octet-stream"});function i(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}return a},sheet2blob_more:function(e){var t=c({},e),n={bookType:"xlsx",bookSST:!1,type:"binary"},r=f.a.write(t,n),o=new Blob([a(r)],{type:"application/octet-stream"});function a(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}return o},openDownloadDialog:function(e,t){"object"==a(e)&&e instanceof Blob&&(e=URL.createObjectURL(e));var n,r=document.createElement("a");r.href=e,r.download=t||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),r.dispatchEvent(n)}},watch:{},mounted:function(){},created:function(){}},p=d,h=n("2877"),v=Object(h["a"])(p,r,o,!1,null,"4c1d57bc",null);t["default"]=v.exports},"44e7":function(e,t,n){var r=n("861d"),o=n("c6b6"),a=n("b622"),i=a("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},"4de4":function(e,t,n){"use strict";var r=n("23e7"),o=n("b727").filter,a=n("1dde"),i=n("ae40"),l=a("filter"),c=i("filter");r({target:"Array",proto:!0,forced:!l||!c},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},9263:function(e,t,n){"use strict";var r=n("ad6d"),o=n("9f7f"),a=RegExp.prototype.exec,i=String.prototype.replace,l=a,c=function(){var e=/a/,t=/b*/g;return a.call(e,"a"),a.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),s=o.UNSUPPORTED_Y||o.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],f=c||u||s;f&&(l=function(e){var t,n,o,l,f=this,d=s&&f.sticky,p=r.call(f),h=f.source,v=0,g=e;return d&&(p=p.replace("y",""),-1===p.indexOf("g")&&(p+="g"),g=String(e).slice(f.lastIndex),f.lastIndex>0&&(!f.multiline||f.multiline&&"\n"!==e[f.lastIndex-1])&&(h="(?: "+h+")",g=" "+g,v++),n=new RegExp("^(?:"+h+")",p)),u&&(n=new RegExp("^"+h+"$(?!\\s)",p)),c&&(t=f.lastIndex),o=a.call(d?n:f,g),d?o?(o.input=o.input.slice(v),o[0]=o[0].slice(v),o.index=f.lastIndex,f.lastIndex+=o[0].length):f.lastIndex=0:c&&o&&(f.lastIndex=f.global?o.index+o[0].length:t),u&&o&&o.length>1&&i.call(o[0],n,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(o[l]=void 0)})),o}),e.exports=l},"9f7f":function(e,t,n){"use strict";var r=n("d039");function o(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},ac1f:function(e,t,n){"use strict";var r=n("23e7"),o=n("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},d784:function(e,t,n){"use strict";n("ac1f");var r=n("6eeb"),o=n("d039"),a=n("b622"),i=n("9263"),l=n("9112"),c=a("species"),s=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),f=a("replace"),d=function(){return!!/./[f]&&""===/./[f]("a","$0")}(),p=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,f){var h=a(e),v=!o((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),g=v&&!o((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!v||!g||"replace"===e&&(!s||!u||d)||"split"===e&&!p){var b=/./[h],x=n(h,""[e],(function(e,t,n,r,o){return t.exec===i?v&&!o?{done:!0,value:b.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),m=x[0],y=x[1];r(String.prototype,e,m),r(RegExp.prototype,h,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}f&&l(RegExp.prototype[h],"sham",!0)}},dbb4:function(e,t,n){var r=n("23e7"),o=n("83ab"),a=n("56ef"),i=n("fc6a"),l=n("06cf"),c=n("8418");r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){var t,n,r=i(e),o=l.f,s=a(r),u={},f=0;while(s.length>f)n=o(r,t=s[f++]),void 0!==n&&c(u,t,n);return u}})},e439:function(e,t,n){var r=n("23e7"),o=n("d039"),a=n("fc6a"),i=n("06cf").f,l=n("83ab"),c=o((function(){i(1)})),s=!l||c;r({target:"Object",stat:!0,forced:s,sham:!l},{getOwnPropertyDescriptor:function(e,t){return i(a(e),t)}})}}]);