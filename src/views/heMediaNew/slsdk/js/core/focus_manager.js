var Focus_entry=function(){this.focus_notify_cb=null,this.priority=0,this.status=0,this.requestor=null},Focus=function(t){this.PriorityType={SESSION_SPEAK_PRIOR_BASE:3e4,SESSION_SESSION_GROUP_PRIORITY:30005,PLAY_RECORDED_FILE_PRIOR_BROADCAST:3e4,PLAY_RECORDED_FILE_PRIOR_RECORD:30100,RECORCER_PRIOR:30100,SESSION_SPEAKING_GROUP_PRIORITY:4e4,PLAY_RECORDED_FILE_EMERGENCY:40005},this.ctx=t,this.current=null,this.requestors=new Array};Focus.prototype.destroy=function(){this.ctx=null,this.current=null,this.requestors=null},Focus.prototype.reset=function(){this.current=null,this.requestors=null,this.requestors=new Array},Focus.prototype.require=function(t,r,s,e){if(this.current){if(t.gid>0&&this.current.requestor.gid==t.gid&&this.current.status==r)return!0;if((i=new Focus_entry).requestor=t,i.priority=s,i.status=r,i.focus_notify_cb=e,s>this.current.priority){var u=this.current;return this.current=i,this.requestors.unshift(u),u.focus_notify_cb(u.requestor,!1),!0}for(let t=0;t<this.requestors.length;t++)if(this.requestors[t].priority<i.priority)return this.requestors.splice(t,0,i),!1;return this.requestors.push(i),!1}var i;return(i=new Focus_entry).requestor=t,i.priority=s,i.status=r,i.focus_notify_cb=e,this.current=i,!0},Focus.prototype.require_nowait=function(t,r,s,e){if(console.log("请求焦点",t),console.log("请求焦点",r),console.log("请求焦点",s),console.log("请求焦点",e),console.log("请求焦点this.current",this.current),this.current){if(t.gid>0&&this.current.requestor.gid==t.gid&&this.current.status==r)return!0;if(s>this.current.priority){let u=this.current;return this.current=new Focus_entry,this.current.requestor=t,this.current.priority=s,this.current.status=r,this.current.focus_notify_cb=e,this.requestors.unshift(u),u.focus_notify_cb(u.requestor,!1),!0}return!1}{let u=new Focus_entry;return u.requestor=t,u.priority=s,u.status=r,u.focus_notify_cb=e,this.current=u,!0}},Focus.prototype.release=function(t,r){if(console.log("释放焦点",t,r),console.log("释放焦点this.current",this.current),this.current&&this.current.requestor.gid==t.gid&&this.current.status==r)console.log("释放成功"),this.current=null,this.current=this.requestors.shift(),this.current&&this.current.focus_notify_cb(this.current.requestor,!0);else{console.log("释放失败");for(let s=0;s<this.requestors.length;s++)if(this.requestors[s].requestor.gid==t.gid&&this.requestors[s].status==r){this.requestors.splice(s,1);break}}},Focus.prototype.current_requestor=function(){return this.current?this.current.requestor:null},Focus.prototype.current_status=function(){return this.current?this.current.status:-1},Focus.prototype.current_priority=function(){return this.current?this.current.priority:0};export default Focus;